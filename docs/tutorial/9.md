## 9 - Scaling & Auto-scaling

This assumes you're still running the local LXC JXaaS, as in step 5 & 6

ElasticSearch is a charm that supports good scaling.

### Scaling

Create an elasticsearch instance, and show the current scaling state:

```
jxaas create-instance es es9
jxaas wait es es9

jxaas get-scaling es es9
```

You can set the charm to a specific scale:
```
jxaas set-scaling es es9 --scale_max 2 --scale_min 2
jxaas get-scaling es es9
```

You can also query elasticsearch for the cluster state:
```
IP=
curl http://${ip}:9200/_nodes?pretty
```

### Scaling

More exciting is to use auto-scaling; auto-scaling tries to keep a metric in the specified range.

We can configure the ES charm to auto-scale based on the cluster load:
```
jxaas set-scaling es es9 --scale_min 1 --scale_max 8 
```

Now, as the load changes, JXaaS will automatically tell Juju to adjust the cluster size to try to keep the metric
in the target range.