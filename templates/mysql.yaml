mysql:
  services:
    mysql:
      charm: "cs:~justin-fathomdb/trusty/mysql"
      num_units: <<
      exposed: true
      options:
        performance: <<
        slow-query-time: <<

    stubclient:
      charm: "cs:~justin-fathomdb/trusty/stub-client"
      options:
        private-port: 3306
        public-port: {{.AssignPublicPort}}

    metrics:
      charm: "cs:~justin-fathomdb/trusty/heka-collector"
  relations:
    - - "stubclient:juju-info"
      - "mysql:juju-info"
    - - "stubclient:mysql"
      - "mysql:db"

    - - "metrics:juju-info"
      - "mysql:juju-info"
    - - "metrics:elasticsearch"
      - "{{.SystemServices.elasticsearch}}:cluster"

    - - "stubclient:website"
      - "{{.SystemServices.haproxy}}:reverseproxy"
